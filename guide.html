<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Tree App - Complete Implementation Guide</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        h3 {
            color: #555;
        }
        .file-structure {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #28a745;
            font-family: 'Courier New', monospace;
            white-space: pre;
            overflow-x: auto;
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .info {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .success {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .module-card {
            background: #f8f9fa;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            border: 1px solid #dee2e6;
        }
        .module-title {
            font-weight: bold;
            color: #3498db;
            margin-bottom: 10px;
        }
        ul {
            margin-left: 20px;
        }
        li {
            margin-bottom: 8px;
        }
        .step {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            display: inline-block;
            margin: 10px 0;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background: #3498db;
            color: white;
        }
        tr:hover {
            background: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ³ Family Tree Application - Complete Implementation Guide</h1>
        
        <div class="info">
            <strong>ğŸ“Œ Version:</strong> 2.0 (Modular Architecture)<br>
            <strong>ğŸ¯ Goal:</strong> Replace Graphviz with interactive PyQt-based visualization<br>
            <strong>âœ¨ Key Features:</strong> Drag & drop, zoom, modern UI, modular code
        </div>

        <h2>ğŸ“‚ Project Structure</h2>
        <div class="file-structure">family_tree/
â”œâ”€â”€ README.md
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ main.py                    # Main entry point
â”œâ”€â”€ config.py                  # Configuration settings
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ person.py             # Person model
â”‚   â””â”€â”€ relationship.py       # Relationship model
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ db_manager.py         # Database operations
â”œâ”€â”€ business/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ duplicate_detector.py # (Copy from original)
â”‚   â”œâ”€â”€ validator.py          # Business rules validation
â”‚   â””â”€â”€ import_export.py      # (Copy from original)
â”œâ”€â”€ visualization/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ tree_renderer.py      # Interactive PyQt tree
â”‚   â””â”€â”€ graph_layout.py       # Layout algorithms
â”œâ”€â”€ gui/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main_window.py        # Main window
â”‚   â”œâ”€â”€ person_form.py        # (Copy from original)
â”‚   â”œâ”€â”€ relationship_form.py  # (Copy from original)
â”‚   â””â”€â”€ duplicate_dialog.py   # (Copy from original)
â””â”€â”€ utils/
    â”œâ”€â”€ __init__.py
    â””â”€â”€ sample_data.py        # (Copy from original)</div>

        <h2>ğŸš€ Quick Setup Guide</h2>
        
        <div class="step">Step 1: Create Directory Structure</div>
        <div class="code-block">mkdir -p family_tree/{models,database,business,visualization,gui,utils}
cd family_tree
touch {models,database,business,visualization,gui,utils}/__init__.py</div>

        <div class="step">Step 2: Create requirements.txt</div>
        <div class="code-block">PySide6>=6.5.0
sqlalchemy>=2.0.0
pillow>=10.0.0
rapidfuzz>=3.0.0</div>

        <div class="step">Step 3: Install Dependencies</div>
        <div class="code-block">python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt</div>

        <h2>ğŸ“‹ Module Overview</h2>

        <div class="module-card">
            <div class="module-title">config.py</div>
            Central configuration for:
            <ul>
                <li>Database path and settings</li>
                <li>Tree visualization parameters (colors, spacing, fonts)</li>
                <li>UI window dimensions</li>
                <li>Duplicate detection thresholds</li>
            </ul>
        </div>

        <div class="module-card">
            <div class="module-title">models/person.py</div>
            Person entity with:
            <ul>
                <li>Basic fields: name, DOB, gender, address, notes</li>
                <li>External IDs (JSON field for flexible ID storage)</li>
                <li>Timestamps: created_at, updated_at</li>
                <li>Helper methods: to_dict(), age property, display_name</li>
            </ul>
        </div>

        <div class="module-card">
            <div class="module-title">models/relationship.py</div>
            Relationship entity:
            <ul>
                <li>Types: parent, spouse, adoptive_parent, guardian</li>
                <li>Bidirectional links (person_a_id, person_b_id)</li>
                <li>Optional start/end dates</li>
                <li>Unique constraint to prevent duplicates</li>
            </ul>
        </div>

        <div class="module-card">
            <div class="module-title">database/db_manager.py</div>
            Database operations:
            <ul>
                <li>Singleton pattern for single DB connection</li>
                <li>CRUD operations for persons</li>
                <li>Relationship queries (get parents, children, spouses)</li>
                <li>Search functionality</li>
                <li>Audit logging</li>
            </ul>
        </div>

        <div class="module-card">
            <div class="module-title">business/validator.py</div>
            Business rules:
            <ul>
                <li>Validate person data (name required, length limits)</li>
                <li>Validate relationships (no self-relationships, age checks)</li>
                <li>Parent-child age difference validation (12+ years)</li>
                <li>Duplicate relationship prevention</li>
            </ul>
        </div>

        <div class="module-card">
            <div class="module-title">visualization/tree_renderer.py</div>
            <strong>â­ NEW: Interactive Visualization</strong>
            <ul>
                <li>PersonNode: Draggable, colored boxes with person info</li>
                <li>RelationshipLine: Curved lines for parent-child, dashed for spouses</li>
                <li>FamilyTreeView: QGraphicsView with zoom/pan support</li>
                <li>Gender-based coloring (male=blue, female=pink)</li>
                <li>Highlight selected person</li>
            </ul>
        </div>

        <div class="module-card">
            <div class="module-title">visualization/graph_layout.py</div>
            <strong>â­ NEW: Smart Layout Algorithm</strong>
            <ul>
                <li>Hierarchical layout (generations as levels)</li>
                <li>BFS traversal from center person</li>
                <li>Automatic spouse grouping</li>
                <li>Centered, balanced layout</li>
                <li>Configurable spacing</li>
            </ul>
        </div>

        <div class="module-card">
            <div class="module-title">gui/main_window.py</div>
            Main application window:
            <ul>
                <li>Three-panel layout: list | details | tree</li>
                <li>Search/filter functionality</li>
                <li>CRUD buttons for persons</li>
                <li>Interactive tree view with depth control</li>
                <li>Menu bar with shortcuts</li>
            </ul>
        </div>

        <h2>âœ¨ Key Improvements Over Original</h2>

        <table>
            <thead>
                <tr>
                    <th>Aspect</th>
                    <th>Original (Graphviz)</th>
                    <th>New (PyQt)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Visualization</td>
                    <td>Static PNG images</td>
                    <td>Interactive, draggable nodes</td>
                </tr>
                <tr>
                    <td>Navigation</td>
                    <td>Fixed view</td>
                    <td>Zoom & pan support</td>
                </tr>
                <tr>
                    <td>Code Structure</td>
                    <td>Single 1000+ line file</td>
                    <td>Modular, 10+ separate files</td>
                </tr>
                <tr>
                    <td>Layout</td>
                    <td>Basic Graphviz algorithm</td>
                    <td>Custom hierarchical layout</td>
                </tr>
                <tr>
                    <td>Styling</td>
                    <td>Limited Graphviz options</td>
                    <td>Full Qt styling control</td>
                </tr>
                <tr>
                    <td>Performance</td>
                    <td>Re-render entire tree</td>
                    <td>Efficient scene graph</td>
                </tr>
                <tr>
                    <td>Dependencies</td>
                    <td>Requires Graphviz system binary</td>
                    <td>Pure Python (no external binaries)</td>
                </tr>
            </tbody>
        </table>

        <h2>ğŸ® User Features</h2>

        <h3>Interactive Tree Navigation</h3>
        <ul>
            <li><strong>Drag nodes:</strong> Click and drag any person box to reposition</li>
            <li><strong>Zoom:</strong> Mouse wheel to zoom in/out</li>
            <li><strong>Pan:</strong> Right-click drag to move view</li>
            <li><strong>Depth control:</strong> Adjust how many generations to show</li>
        </ul>

        <h3>Visual Design</h3>
        <ul>
            <li><strong>Gender coloring:</strong> Male (blue), Female (pink), Unknown (gray)</li>
            <li><strong>Highlighted selection:</strong> Selected person in gold</li>
            <li><strong>Relationship lines:</strong> Solid for parent-child, dashed for spouses</li>
            <li><strong>Smooth curves:</strong> Bezier curves for parent-child connections</li>
        </ul>

        <h2>ğŸ”§ Modules to Copy from Original</h2>

        <div class="warning">
            <strong>âš ï¸ Important:</strong> The following modules can be copied almost directly from your original code:
        </div>

        <ol>
            <li><strong>business/duplicate_detector.py</strong> - DuplicateDetector class</li>
            <li><strong>business/import_export.py</strong> - ImportExport class</li>
            <li><strong>gui/person_form.py</strong> - PersonFormDialog</li>
            <li><strong>gui/relationship_form.py</strong> - RelationshipFormDialog</li>
            <li><strong>gui/duplicate_dialog.py</strong> - DuplicateDetectionDialog</li>
            <li><strong>utils/sample_data.py</strong> - create_sample_data function</li>
        </ol>

        <p>Just make sure to update the imports to use the new modular structure!</p>

        <h2>ğŸƒâ€â™‚ï¸ Running the Application</h2>

        <div class="code-block">python main.py</div>

        <div class="success">
            <strong>âœ… Expected Output:</strong><br>
            <pre>============================================================
Family Tree / Census Helper Application
Version 2.0
============================================================

âœ“ rapidfuzz available - advanced duplicate detection enabled

Initializing database...
Creating sample data...
Sample data created successfully!

Starting application...

FEATURES:
  - Interactive tree visualization
  - Drag nodes to reposition
  - Scroll to zoom in/out
  - Right-click drag to pan

KEYBOARD SHORTCUTS:
  Ctrl+N - Add new person
  Ctrl+E - Edit selected person
  Ctrl+D - Delete selected person
  Ctrl+F - Find duplicates
  Ctrl+S - Export data
============================================================</pre>
        </div>

        <h2>ğŸ“ Example Usage Flow</h2>

        <ol>
            <li>Launch app â†’ Sample family (Sharma family) loads automatically</li>
            <li>Click "Rajesh Sharma" in left panel</li>
            <li>View family tree showing Rajesh, Sita (spouse), and children</li>
            <li>Use mouse wheel to zoom in/out</li>
            <li>Drag nodes to rearrange (positions aren't saved, just visual)</li>
            <li>Adjust "Tree Depth" to 4 to see grandparents (if any)</li>
            <li>Click "Add Person" to create new family member</li>
            <li>Click "Add Relationship" to link them</li>
            <li>Tree updates automatically</li>
        </ol>

        <h2>ğŸ§ª Testing Checklist</h2>

        <div class="info">
            <input type="checkbox"> Tree renders with color-coded nodes<br>
            <input type="checkbox"> Can zoom in/out with mouse wheel<br>
            <input type="checkbox"> Can drag to pan the view<br>
            <input type="checkbox"> Nodes are draggable<br>
            <input type="checkbox"> Parent-child lines are curved and solid<br>
            <input type="checkbox"> Spouse lines are straight and dashed<br>
            <input type="checkbox"> Selected person highlighted in gold<br>
            <input type="checkbox"> Search filters the person list<br>
            <input type="checkbox"> Add person creates new node<br>
            <input type="checkbox"> Add relationship updates tree<br>
            <input type="checkbox"> Delete removes node from tree<br>
            <input type="checkbox"> Export/import preserves data
        </div>

        <h2>ğŸ¨ Customization</h2>

        <p>All visual settings are in <code>config.py</code>:</p>

        <div class="code-block">TREE_CONFIG = {
    'node_width': 150,          # Make nodes wider/narrower
    'node_height': 80,          # Make nodes taller/shorter
    'horizontal_spacing': 40,   # Space between siblings
    'vertical_spacing': 100,    # Space between generations
    'male_color': '#ADD8E6',    # Change male node color
    'female_color': '#FFB6C1',  # Change female node color
    'font_size': 10,            # Adjust text size
    ...
}</div>

        <h2>ğŸ› Troubleshooting</h2>

        <h3>Import Errors</h3>
        <p>Make sure all <code>__init__.py</code> files exist in each package directory.</p>

        <h3>Tree Not Rendering</h3>
        <p>Check that you're calling <code>refresh_tree()</code> after selecting a person.</p>

        <h3>Nodes Overlapping</h3>
        <p>Increase spacing values in <code>config.py</code>.</p>

        <h3>Performance Issues</h3>
        <p>Reduce tree depth or limit the number of persons displayed.</p>

        <h2>ğŸ“š Next Steps</h2>

        <ol>
            <li>Add node selection highlighting on click</li>
            <li>Implement save/load of node positions</li>
            <li>Add tooltips showing full person details on hover</li>
            <li>Export tree as image (PNG/SVG)</li>
            <li>Add timeline view</li>
            <li>Implement undo/redo functionality</li>
            <li>Add photo support for person nodes</li>
        </ol>

        <div class="success">
            <strong>ğŸ‰ Congratulations!</strong> You now have a fully modular, interactive family tree application with modern visualization capabilities!
        </div>
    </div>
</body>
</html>